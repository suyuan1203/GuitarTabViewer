var alphaTabWrapper;
(function(e){alphaTabWrapper=function(g,h){var b=this;this.el=g=e(g);this.factory=new alphatab.tablature.model.SongFactoryImpl;var j=e("script[src$=/alphaTab.js]");if(j.length==0)j=e("script[src$=/alphaTab.min.js]");var i="";if(j.length){i=function(a){var c=location,f,d;if(/^\w+:/.test(a))return a;f=c.protocol+"//"+c.host;if(a.indexOf("/")==0)return f+a;c=c.pathname.replace(/\/[^\/]*$/,"");if(d=a.match(/\.\.\//g)){a=a.substring(d.length*3);for(d=d.length;d--;)c=c.substring(0,c.lastIndexOf("/"))}return f+c+
"/"+a}(j.attr("src"));i=i.substr(0,i.lastIndexOf("/"))}this.options=e.extend({base:i,file:null,track:0,loadCallback:null,errorCallback:null,error:"Load a file to display the tablature",zoom:1.1,width:600,height:200,autoSize:true},h);this.loadAlphaTex=function(a){try{b.tablature.isError=false;var c=new alphatab.file.alphatex.AlphaTexParser,f=new alphatab.platform.BinaryReader;f.initialize(a);c.init(f,b.factory);k(c.readSong())}catch(d){l(d)}};this.loadFile=function(a){try{alphatab.file.SongLoader.loadSong(a,
b.factory,k)}catch(c){l(c)}};this.loadCallbacks=[];var k=function(a){b.options.loadCallback&&b.options.loadCallback(a);b.tablature.setTrack(a.tracks[b.options.track]);for(var c=0;c<b.loadCallbacks.length;c++)b.loadCallbacks[c](a)},l=function(a){if(a instanceof alphatab.file.FileFormatException)a=a.message;if(b.options.errorCallback)b.options.errorCallback(a);else{b.tablature.isError=true;b.tablature.updateDisplay=true;b.tablature.errorMessage=a;b.tablature.invalidate()}};this.contents=e.trim(g.text());
g.html("");document.createElement("canvas");this.canvas=e('<canvas width="'+this.options.width+'" height="'+this.options.height+'" class="alphaTabSurface"></canvas>');g.append(this.canvas);this.canvas=this.canvas[0];if(e.browser.msie)if(e.browser.version<9)this.canvas=G_vmlCanvasManager.initElement(function(a){var c=a.outerHTML,f=a.ownerDocument.createElement(c);if(c.slice(-2)!="/>"){c="/"+a.tagName;for(var d;(d=a.nextSibling)&&d.tagName!=c;)d.removeNode();d&&d.removeNode()}a.parentNode.replaceChild(f,
a);return f}(this.canvas));this.tablature=new alphatab.tablature.Tablature(this.canvas,this.options.error);this.tablature.autoSizeWidth=this.options.autoSize;this.tablature.updateScale(this.options.zoom);if(this.options.file)this.loadFile(this.options.file);else this.contents!=""&&this.loadAlphaTex(this.contents)};alphaTabWrapper.fn=alphaTabWrapper.prototype;e.fn.alphaTab=function(g){for(var h=[],b=0;b<this.length;b++){if(!this[b].alphaTab)this[b].alphaTab=new alphaTabWrapper(this[b],g);h.push(this[b].alphaTab)}return h.length>
1?h:h[0]}})(jQuery);document.write('<script type="text/vbscript">\nFunction VbAjaxLoader(method, fileName)\n\tDim xhr\n\tSet xhr = CreateObject("Microsoft.XMLHTTP")\n\n\txhr.Open method, fileName, False\n\n\txhr.setRequestHeader "Accept-Charset", "x-user-defined"\n\txhr.send\n\n\tDim byteArray()\n\n\tif xhr.Status = 200 Then\n\t\tDim byteString\n\t\tDim i\n\n\t\tbyteString=xhr.responseBody\n\n\t\tReDim byteArray(LenB(byteString))\n\n\t\tFor i = 1 To LenB(byteString)\n\t\t\tbyteArray(i-1) = AscB(MidB(byteString, i, 1))\n\t\tNext\n\tEnd If\n\n\tVbAjaxLoader=byteArray\nEnd Function\n<\/script>');
